# Version 3: Number the points and provide a separate legend
df$id <- 1:nrow(df)

p_numbered <- ggplot(df, aes(x = beta, y = r_squared)) +
  geom_point(aes(color = effect_direction), size = 4, alpha = 0.9) +
  geom_text(aes(label = id), size = 2.5, color = "white", fontface = "bold") +
  geom_hline(yintercept = 0.06, linetype = "dashed", color = "gray40", size = 0.7) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "gray40", size = 0.7) +
  scale_x_continuous(limits = c(-0.15, 0.15), breaks = seq(-0.1, 0.1, 0.05)) +
  scale_y_continuous(limits = c(-0.01, 0.15), breaks = seq(0, 0.15, 0.05)) +
  scale_color_manual(values = c("Improves Rank" = "#0571b0", "Worsens Rank" = "#ca0020")) +
  labs(
    title = "Hogan Predictors for AOM (Academic)",
    subtitle = "Numbers correspond to predictor list (outlier #X with Î² = -0.4 not shown)",
    x = "Standardized Beta",
    y = "R-squared"
  ) +
  theme_classic(base_size = 14) +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.subtitle = element_text(size = 11, face = "italic", color = "gray50"),
    legend.position = c(0.85, 0.9),
    legend.background = element_rect(fill = "white", color = NA)
  )

ggsave("hogan_numbered.png", p_numbered, width = 8, height = 6, dpi = 150)

# Print the legend separately
print(df[order(-df$r_squared), c("id", "predictor", "beta", "r_squared")])
